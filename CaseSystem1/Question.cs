//------------------------------------------------------------------------------
// <auto-generated>
//    Этот код был создан из шаблона.
//
//    Изменения, вносимые в этот файл вручную, могут привести к непредвиденной работе приложения.
//    Изменения, вносимые в этот файл вручную, будут перезаписаны при повторном создании кода.
// </auto-generated>
//------------------------------------------------------------------------------

namespace CaseSystem1
{
    using System;
    using System.Collections.Generic;
    using System.Linq;

    public partial class Question
    {
        public Question()
        {
            this.Conditions = new HashSet<Condition>();
            this.Reports = new HashSet<Report>();
            this.Attributes = new HashSet<Attribute>();
        }
    
        public int Id { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }
    
        public virtual ICollection<Condition> Conditions { get; set; }
        public virtual ICollection<Report> Reports { get; set; }
        public virtual ICollection<Attribute> Attributes { get; set; }
        //метод, выполняющий запрос по сущестующим условиям
        public List<string> Execute()
        {
            List<string> numOfExemp = new List<string>();   //список хранимых значений (строк, ид сущности + . + номер экземпляра сущности)
            foreach (Condition cond in Conditions)  //обход условий
            {
                List<string> dullyList = new List<string>();
                switch (cond.Operation) //проверка операций соединения условий запросов
                {
                    //для "" и ИЛИ одинаковое решение
                    case "":
                    case "OR":
                        switch (cond.Compare)   //проверка операций сравнения
                        {
                            case ">":
                                switch (cond.Attribute.Type)    //проверка типов данных
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)  //проверка на отрицание
                                            {
                                                if (Byte.Parse(atv.Value) > Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) <= Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) > Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) <= Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) > float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) <= float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) <= Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) > Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) <= Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (!(Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value)) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) > DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) <= DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (string.Compare(atv.Value, cond.Value) == 1 && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if ((string.Compare(atv.Value, cond.Value) == -1 || string.Compare(atv.Value, cond.Value) == 0) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case ">=":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) >= Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) < Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) >= Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) < Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) >= float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) < float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) >= Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) < Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) >= Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) < Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (!(!Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value)) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if ((!Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value)) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) >= DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) < DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if ((string.Compare(atv.Value, cond.Value) == 1 || string.Compare(atv.Value, cond.Value) == 0) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (string.Compare(atv.Value, cond.Value) == -1 && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case "=":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) == Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) != Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) == Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) != Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) == float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) != float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) == Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) != Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) == Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) != Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (((Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value)) || (!Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value))) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (((!(Boolean.Parse(atv.Value)) && Boolean.Parse(cond.Value)) || (Boolean.Parse(atv.Value) && !(Boolean.Parse(cond.Value)))) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) == DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) != DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (atv.Value == cond.Value && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (atv.Value != cond.Value && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case "!=":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) != Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) == Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) != Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) == Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) != float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) == float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) != Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) == Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) != Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) == Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (((!(Boolean.Parse(atv.Value)) && Boolean.Parse(cond.Value)) || (Boolean.Parse(atv.Value) && !(Boolean.Parse(cond.Value)))) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (((!(Boolean.Parse(atv.Value)) && !(Boolean.Parse(cond.Value))) || (Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value))) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) != DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) == DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (atv.Value != cond.Value && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (atv.Value == cond.Value && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case "<":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) < Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) >= Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) < Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) >= Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) < float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) >= float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) < Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) >= Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) < Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) >= Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (!Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (!(!Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value)) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) < DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) >= DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (string.Compare(atv.Value, cond.Value) == -1 && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if ((string.Compare(atv.Value, cond.Value) == 1 || string.Compare(atv.Value, cond.Value) == 0) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case "<=":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) <= Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) > Byte.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) <= Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) > Int32.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) <= float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) > float.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) <= Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) <= Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) > Char.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (!(Boolean.Parse(atv.Value) && !(Boolean.Parse(cond.Value))) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Boolean.Parse(atv.Value) && !(Boolean.Parse(cond.Value)) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) <= DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) > DateTime.Parse(cond.Value) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if ((string.Compare(atv.Value, cond.Value) == -1 || string.Compare(atv.Value, cond.Value) == 0) && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (string.Compare(atv.Value, cond.Value) == 1 && !numOfExemp.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    numOfExemp.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                        }
                        break;
                    case "AND":
                        switch (cond.Compare)
                        {
                            case ">":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) > Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) <= Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) > Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) <= Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) > float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) <= float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) <= Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) > Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) <= Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (!(Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value)) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) > DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) <= DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (string.Compare(atv.Value, cond.Value) == 1 && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if ((string.Compare(atv.Value, cond.Value) == -1 || string.Compare(atv.Value, cond.Value) == 0) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case ">=":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) >= Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) < Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) >= Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) < Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) >= float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) < float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) >= Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) < Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) >= Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) < Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (!(!Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value)) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if ((!Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value)) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) >= DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) < DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if ((string.Compare(atv.Value, cond.Value) == 1 || string.Compare(atv.Value, cond.Value) == 0) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (string.Compare(atv.Value, cond.Value) == -1 && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case "=":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) == Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) != Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) == Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) != Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) == float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) != float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) == Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) != Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) == Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) != Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (((Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value)) || (!Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value))) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (((!(Boolean.Parse(atv.Value)) && Boolean.Parse(cond.Value)) || (Boolean.Parse(atv.Value) && !(Boolean.Parse(cond.Value)))) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) == DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) != DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (atv.Value == cond.Value && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (atv.Value != cond.Value && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case "!=":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) != Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) == Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) != Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) == Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) != float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) == float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) != Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) == Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) != Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) == Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (((!(Boolean.Parse(atv.Value)) && Boolean.Parse(cond.Value)) || (Boolean.Parse(atv.Value) && !(Boolean.Parse(cond.Value)))) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (((!(Boolean.Parse(atv.Value)) && !(Boolean.Parse(cond.Value))) || (Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value))) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) != DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) == DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (atv.Value != cond.Value && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (atv.Value == cond.Value && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case "<":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) < Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) >= Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) < Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) >= Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) < float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) >= float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) < Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) >= Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) < Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) >= Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (!Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (!(!Boolean.Parse(atv.Value) && Boolean.Parse(cond.Value)) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) < DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) >= DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (string.Compare(atv.Value, cond.Value) == -1 && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if ((string.Compare(atv.Value, cond.Value) == 1 || string.Compare(atv.Value, cond.Value) == 0) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                            case "<=":
                                switch (cond.Attribute.Type)
                                {
                                    case "Byte":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Byte.Parse(atv.Value) <= Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Byte.Parse(atv.Value) > Byte.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Int":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Int32.Parse(atv.Value) <= Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Int32.Parse(atv.Value) > Int32.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Float":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (float.Parse(atv.Value) <= float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (float.Parse(atv.Value) > float.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (float.Parse(atv.Value) > float.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Double":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Double.Parse(atv.Value) <= Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Double.Parse(atv.Value) > Double.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Char":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (Char.Parse(atv.Value) <= Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Char.Parse(atv.Value) > Char.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "Bool":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (!(Boolean.Parse(atv.Value) && !(Boolean.Parse(cond.Value))) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (Boolean.Parse(atv.Value) && !(Boolean.Parse(cond.Value)) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        //if (Boolean.Parse(atv.Value) && !Boolean.Parse(cond.Value) && !cond.Not)
                                        //if  (Boolean.Parse(atv.Value) > Boolean.Parse(cond.Value) && !cond.Not)
                                        //dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                        break;
                                    case "Date":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if (DateTime.Parse(atv.Value) <= DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (DateTime.Parse(atv.Value) > DateTime.Parse(cond.Value) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                    case "String":
                                        foreach (AttributeValue atv in cond.Attribute.AttributeValues)
                                            if (!cond.Not)
                                            {
                                                if ((string.Compare(atv.Value, cond.Value) == -1 || string.Compare(atv.Value, cond.Value) == 0) && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                            else
                                            {
                                                if (string.Compare(atv.Value, cond.Value) == 1 && !dullyList.Contains(atv.Attribute.Entity.Id + "." + atv.Number))
                                                    dullyList.Add(atv.Attribute.Entity.Id + "." + atv.Number);
                                            }
                                        break;
                                }
                                break;
                        }
                        numOfExemp = numOfExemp.Intersect(dullyList).ToList();
                        break;
                }
            }
            return numOfExemp;
        }
    }
}
